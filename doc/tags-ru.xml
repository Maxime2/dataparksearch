<sect1 id="tags">
	<title>Тэги
<indexterm><primary>Тэги</primary></indexterm>
</title>
	<para>Тэг - специальный параметр, который присваивается группе документов.
Основная задача тэгов заключается в возможности группировать документы 
для ограничения результатов поиска только этой группой документов.
 </para>

	<para><indexterm><primary>Команда</primary><secondary>Tag</secondary></indexterm>
Для присвоения тэга серверу, или части сервера, вы должны использовать команду <userinput>Tag</userinput> в
<filename>indexer.conf</filename>, указав её перед соответсвующей командой <command>Server/Realm/Subnet</command>.
При поиске, вы можете указать тэг задав CGI-параметр
<parameter>t=xxx</parameter>, в HTML форме. Смотрите <filename>indexer.conf-dist</filename> и
<filename>search.htm-dist</filename> в качестве примера.</para>


<sect2 id="tag_cmd">
<title>Команда <command>Tag</command></title>
<indexterm><primary>Команда</primary><secondary>Tag</secondary></indexterm>
<programlisting>
Tag &lt;string&gt;
</programlisting>
<para>
Используйте эту команду по своему усмотрению чтобы сгруппировать несколько сайтов,
помечая их указаным тэгом. При индексировании или поиске, вы можете ограничиваться сайтами только указаного тэга.
Можно указывать несколько команд <command>Tag</command>. Команда <command>Tag</command> имеет значение до следующей
команды <command>Tag</command> или до конца файла конфигурации. 
Значение по умолчанию: пустая строка.
</para>
</sect2>



<sect2 id="tagif_cmd">
<title>Команда <command>TagIf</command></title>
<indexterm><primary>Команда</primary><secondary>TagIf</secondary></indexterm>
<programlisting>
TagIf &lt;tag&gt; [Match|NoMatch] [NoCase|Case] [String|Regex] [loose] &lt;section&gt; &lt;arg&gt; [&lt;arg&gt; ... ]
</programlisting>
<para>
Присвоить документу тэг &lt;tag&gt;, если значении секции <option>section</option> подпадает под указаный
шаблон <option>arg</option>.
Значение первых трёх необязательных параметров такое же как для команды 
<command>Allow</command> (см. <xref linkend="allow_cmd"/>). Необязательный параметр <option>loose</option> используется для задания
более низкого приоритета такому присвоению тэга, т.е. если тэг уже был присвоен на основании параметров сервера, новое значение тэгу
присвоено не будет.
</para>
<para>Пример
<programlisting>
TagIf Docs regex Title Manual
</programlisting>
</para>

<para>В тэге &lt;tag&gt; можно использовать мета-переменные шаблона страницы выдачи (например, $(title), $(Last-Modified)). В примере
ниже для каждого документа в качестве тэга выставляется доменное имя из его URL:
<programlisting>
TagIf $(url.host) match url.host *
</programlisting>
</para>

</sect2>


	<sect2 id="tags-sql">
		<title>Тэги в SQL версии</title>
		<para>Начиная с версии 3.1.x. тип тэгов изменён с INT на CHAR.
Тип CHAR даёт несколько полезных возможностей. Вы може использовать SQL-шаблоны '_' and '%' 
при указании параметра тэга для поиска. Это позволяет тэгам, наравне с категориями,
поддерживать возможность вложенности. Например, документы со значением тэга "AB"
могут быть найдены, если при поиске указаны параметры тэга "A%" или "AB".</para>

		<para>Тэги также дают возможность URL быть членом нескольких групп.
Задавая SQL-шаблоны, вы можете легко создать две и более групп.</para>

		<para>Например, тэг "ABCDE" - подпадает под выборку с такими тэгами в качестве параметра:
		<programlisting>
_BCDE
A_CDE
AB_DE
ABC_E
ABCD_
</programlisting>
</para>
		<note>
			<para>Если у вас достаточно большая база, и ограничения по тэгу используются часто,
весьма полезно создать для таблицы "server" индекс по полю "tag". Этот индекс не создаётся по умолчанию.
<programlisting>
CREATE INDEX srv_tag ON "server" ("tag");
</programlisting>
</para>
<para>
По умолчанию, длина поля "tag" в таблице "server" ограничена 16 символами.
Если вам необходимы более длинные тэги, увеличьте это значение перед созданием базы.
</para>
		</note>
	</sect2>


<note><para>Для способа хранения cache вам нужно указать секцию tag в вашем файле <filename>sections.conf</filename> с ненулевой
максимальной длиной:
<programlisting>
Section tag 0 64
</programlisting>
</para>
</note>


</sect1>
